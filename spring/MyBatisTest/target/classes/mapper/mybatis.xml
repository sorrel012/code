<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace="파일명" -->
<mapper namespace="mybatis">
	<insert id="m1">
		insert into tblMyBatis(seq, name, age, address, gender) values (seqMyBatis.nextVal, '하하하', 23, '서울시 강동구', 'm')
	</insert>
	
	<!-- parameterType은 생략 가능 -->
	<insert id="add" parameterType="com.test.domain.MyBatisDTO">
		insert into tblMyBatis(seq, name, age, address, gender) values (seqMyBatis.nextVal, #{name}, #{age}, #{address}, #{gender})
	</insert>
	
	<delete id="m2" parameterType="String">
		delete from tblMyBatis where seq = #{seq}
	</delete>
	
	<update id="m3" parameterType="java.util.HashMap">
		update tblMyBatis set
			name = #{name},
			address = #{address}
				where seq = #{seq}
	</update>
	
	<!-- resultType은 생략 불가!! 반드시 적어야 한다. + 클래스형으로 -->
	<select id="m4" resultType="Integer">
		select count(*) from tblMyBatis		
	</select>
	
	<select id="m5" parameterType="String" resultType="com.test.domain.MyBatisDTO">
		select * from tblMyBatis where seq = #{seq}
	</select>
	
	<select id="m6" resultType="String">
		select name from tblMybatis
	</select>
	
	<select id="m7" resultType="com.test.domain.MyBatisDTO">
		select * from tblMyBatis		
	</select>
	
	<select id="m8" parameterType="String" resultType="Integer">
		<!--		
			#{key}: 데이터 바인딩 > 문자열 전송 > '문자열' 
			${key}: 식별자 바인딩 > 문자열 전송 > 문자열
		-->	
		select count(*) from ${table}
	</select>
	
	<select id="m9" parameterType="Integer" resultType="com.test.domain.MyBatisDTO">
	
		select * from tblMyBatis
			<![CDATA[  
			where age < #{age}
			]]>
			
	</select>	
	
	<select id="m10" parameterType="String" resultType="com.test.domain.MyBatisDTO">
	
		select * from tblMyBatis 
			where address like '%${word}%'
			<!-- where address like '%' || #{word} || '%'  -->
	
	</select>
	
	<insert id="m11" parameterType="com.test.domain.MyBatisDTO">
	
		<selectKey keyProperty="seq" order="BEFORE" resultType="String">
			select seqmyBatis.nextVal from dual
		</selectKey>
		insert into tblMyBatis(seq, name, age, address, gender) values (#{seq}, #{name}, #{age}, #{address}, #{gender})
	</insert>
	
	<select id="m12" resultType="String">
	
		<!-- <if test="type == 1">
		select first_name from employees
		</if>
		<if test="type == 2">
		select last_name from employees
		</if> -->
		
		select 
			<if test="type == 1">first_name</if>
			<if test="type == 2">last_name</if>
		from employees
		
	</select>
	
	<select id="m13" resultType="com.test.domain.MyBatisDTO">
		
		select * from tblMybatis
			<!-- 
			<if test="column == 'name'">
			where name = #{word}
			</if>
			<if test="column == 'age'">
			<![CDATA[
			where age <= #{word} 
			]]>
			</if>
			<if test="column == 'address'">
			where address like '%${word}%'
			</if>
			-->
			
			<choose>
				<when test="column == 'name'">
					where name = #{word}
				</when>
				<when test="column == 'age'">
					<![CDATA[where age <= #{word}]]>
				</when>
				<otherwise>
					where address like '%${word}%'
				</otherwise>
			</choose>
			
	</select>
	
	<select id="m14" resultType="com.test.domain.MyBatisDTO">
		
		<!--
			1. m14.do
				- select * from tblMyBatis
			2. m14.do?address=서울  
				- select * from tblMyBatis where 조건
		-->
		
		select * from tblMyBatis
			<where>
				<if test="address != null">
					address like '%${address}%'
				</if>
				<trim prefix="and">
					rownum = 1
				</trim>
			</where>
	
	</select>
	
	
	<select id="m15" resultType="com.test.domain.MyBatisDTO">
		
		select * from tblMyBatis
			where name in 
			
			<!-- 
				ArrayList > list
				HashMap > map			
			 -->			
			
			<!-- 
				collection: 예약어 list
				open: foreach 시작에 붙을 것
				close: foreach 끝날 때 붙을 것
				separator: 한 바퀴 돌 때마다 찍힐 것
			 -->
			<foreach collection="list" item="name" open="(" close=")" separator=",">
				#{name}
			</foreach>
		
	</select>
	
</mapper>